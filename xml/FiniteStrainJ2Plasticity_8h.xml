<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="FiniteStrainJ2Plasticity_8h" kind="file" language="C++">
    <compoundname>FiniteStrainJ2Plasticity.h</compoundname>
    <includes refid="MarmotDeformationMeasures_8h" local="yes">Marmot/MarmotDeformationMeasures.h</includes>
    <includes refid="MarmotEnergyDensityFunctions_8h" local="yes">Marmot/MarmotEnergyDensityFunctions.h</includes>
    <includes refid="MarmotFastorTensorBasics_8h" local="yes">Marmot/MarmotFastorTensorBasics.h</includes>
    <includes refid="MarmotFiniteStrainPlasticity_8h" local="yes">Marmot/MarmotFiniteStrainPlasticity.h</includes>
    <includes refid="MarmotMaterialFiniteStrain_8h" local="yes">Marmot/MarmotMaterialFiniteStrain.h</includes>
    <includes refid="MarmotMath_8h" local="yes">Marmot/MarmotMath.h</includes>
    <includes refid="MarmotStateVarVectorManager_8h" local="yes">Marmot/MarmotStateVarVectorManager.h</includes>
    <includes refid="MarmotTypedefs_8h" local="yes">Marmot/MarmotTypedefs.h</includes>
    <includes local="no">string</includes>
    <includedby refid="FiniteStrainJ2Plasticity_8cpp" local="yes">/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/src/FiniteStrainJ2Plasticity.cpp</includedby>
    <includedby refid="FiniteStrainJ2PlasticityRegistration_8cpp" local="yes">/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/src/FiniteStrainJ2PlasticityRegistration.cpp</includedby>
    <incdepgraph>
      <node id="7">
        <label>Marmot/MarmotJournal.h</label>
        <link refid="MarmotJournal_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="28">
        <label>Marmot/MarmotMaterial.h</label>
        <link refid="MarmotMaterial_8h"/>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>Marmot/MarmotUtils.h</label>
        <link refid="MarmotUtils_8h"/>
      </node>
      <node id="2">
        <label>Marmot/MarmotDeformationMeasures.h</label>
        <link refid="MarmotDeformationMeasures_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>Marmot/MarmotEnergyDensityFunctions.h</label>
        <link refid="MarmotEnergyDensityFunctions_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>Marmot/MarmotFiniteStrainPlasticity.h</label>
        <link refid="MarmotFiniteStrainPlasticity_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>Marmot/MarmotMaterialFiniteStrain.h</label>
        <link refid="MarmotMaterialFiniteStrain_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>Marmot/MarmotConstants.h</label>
        <link refid="MarmotConstants_8h"/>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>Marmot/MarmotFastorTensorBasics.h</label>
        <link refid="MarmotFastorTensorBasics_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>Marmot/MarmotMath.h</label>
        <link refid="MarmotMath_8h"/>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>Marmot/MarmotTensor.h</label>
        <link refid="MarmotTensor_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>Marmot/MarmotTensorExponential.h</label>
        <link refid="MarmotTensorExponential_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>Marmot/MarmotTypedefs.h</label>
        <link refid="MarmotTypedefs_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>Marmot/MarmotStateVarVectorManager.h</label>
        <link refid="MarmotStateVarVectorManager_8h"/>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>Marmot/MarmotVoigt.h</label>
        <link refid="MarmotVoigt_8h"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/include/Marmot/FiniteStrainJ2Plasticity.h</label>
        <link refid="FiniteStrainJ2Plasticity_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>Eigen/Core</label>
      </node>
      <node id="12">
        <label>Eigen/Dense</label>
      </node>
      <node id="5">
        <label>Fastor/Fastor.h</label>
      </node>
      <node id="30">
        <label>Fastor/tensor/Tensor.h</label>
      </node>
      <node id="20">
        <label>algorithm</label>
      </node>
      <node id="18">
        <label>autodiff/forward/dual.hpp</label>
      </node>
      <node id="21">
        <label>autodiff/forward/dual/dual.hpp</label>
      </node>
      <node id="19">
        <label>autodiff/forward/real.hpp</label>
      </node>
      <node id="17">
        <label>cmath</label>
      </node>
      <node id="22">
        <label>complex</label>
      </node>
      <node id="8">
        <label>iostream</label>
      </node>
      <node id="32">
        <label>memory</label>
      </node>
      <node id="9">
        <label>sstream</label>
      </node>
      <node id="10">
        <label>string</label>
      </node>
      <node id="33">
        <label>unordered_map</label>
      </node>
      <node id="13">
        <label>unsupported/Eigen/CXX11/Tensor</label>
      </node>
      <node id="23">
        <label>utility</label>
      </node>
      <node id="34">
        <label>vector</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1">
        <label>/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/include/Marmot/FiniteStrainJ2Plasticity.h</label>
        <link refid="FiniteStrainJ2Plasticity_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/src/FiniteStrainJ2Plasticity.cpp</label>
        <link refid="FiniteStrainJ2Plasticity_8cpp"/>
      </node>
      <node id="3">
        <label>/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/src/FiniteStrainJ2PlasticityRegistration.cpp</label>
        <link refid="FiniteStrainJ2PlasticityRegistration_8cpp"/>
      </node>
    </invincdepgraph>
    <innerclass refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity" prot="public">Marmot::Materials::FiniteStrainJ2Plasticity</innerclass>
    <innerclass refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager" prot="public">Marmot::Materials::FiniteStrainJ2Plasticity::FiniteStrainJ2PlasticityStateVarManager</innerclass>
    <innernamespace refid="namespaceMarmot">Marmot</innernamespace>
    <innernamespace refid="namespaceMarmot_1_1Materials">Marmot::Materials</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>---------------------------------------------------------------------</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/><sp/>_<sp/>__<sp/>___<sp/><sp/><sp/>__<sp/>_<sp/>_<sp/>__<sp/>_<sp/>__<sp/>___<sp/><sp/><sp/>___<sp/>|<sp/>|_</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>|<sp/>&apos;_<sp/>`<sp/>_<sp/>\<sp/>/<sp/>_`<sp/>|<sp/>&apos;__|<sp/>&apos;_<sp/>`<sp/>_<sp/>\<sp/>/<sp/>_<sp/>\|<sp/>__|</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>|<sp/>|<sp/>|<sp/>|<sp/>|<sp/>|<sp/>(_|<sp/>|<sp/>|<sp/><sp/>|<sp/>|<sp/>|<sp/>|<sp/>|<sp/>|<sp/>(_)<sp/>|<sp/>|_</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>|_|<sp/>|_|<sp/>|_|\__,_|_|<sp/><sp/>|_|<sp/>|_|<sp/>|_|\___/<sp/>\__|</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>Unit<sp/>of<sp/>Strength<sp/>of<sp/>Materials<sp/>and<sp/>Structural<sp/>Analysis</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>University<sp/>of<sp/>Innsbruck</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>2020<sp/>-<sp/>today</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>festigkeitslehre@uibk.ac.at</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/>Alexander<sp/>Dummer<sp/>alexander.dummer@uibk.ac.at</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>This<sp/>file<sp/>is<sp/>part<sp/>of<sp/>the<sp/>MAteRialMOdellingToolbox<sp/>(marmot).</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>This<sp/>library<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>modify<sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>Lesser<sp/>General<sp/>Public</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>License<sp/>as<sp/>published<sp/>by<sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>version<sp/>2.1<sp/>of<sp/>the<sp/>License,<sp/>or<sp/>(at<sp/>your<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>The<sp/>full<sp/>text<sp/>of<sp/>the<sp/>license<sp/>can<sp/>be<sp/>found<sp/>in<sp/>the<sp/>file<sp/>LICENSE.md<sp/>at</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>the<sp/>top<sp/>level<sp/>directory<sp/>of<sp/>marmot.</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>---------------------------------------------------------------------</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotDeformationMeasures_8h" kindref="compound">Marmot/MarmotDeformationMeasures.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotEnergyDensityFunctions_8h" kindref="compound">Marmot/MarmotEnergyDensityFunctions.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotFastorTensorBasics_8h" kindref="compound">Marmot/MarmotFastorTensorBasics.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotFiniteStrainPlasticity_8h" kindref="compound">Marmot/MarmotFiniteStrainPlasticity.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotMaterialFiniteStrain_8h" kindref="compound">Marmot/MarmotMaterialFiniteStrain.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotMath_8h" kindref="compound">Marmot/MarmotMath.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotStateVarVectorManager_8h" kindref="compound">Marmot/MarmotStateVarVectorManager.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="MarmotTypedefs_8h" kindref="compound">Marmot/MarmotTypedefs.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceMarmot_1_1Materials" kindref="compound">Marmot::Materials</ref><sp/>{</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal">Fastor;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceMarmot_1_1FastorStandardTensors" kindref="compound">FastorStandardTensors</ref>;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceMarmot_1_1FastorIndices" kindref="compound">FastorIndices</ref>;</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity" refkind="compound"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aff76dcef75e33d757316b16ad6859ad3" kindref="member">FiniteStrainJ2Plasticity</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classMarmotMaterialFiniteStrain" kindref="compound">MarmotMaterialFiniteStrain</ref><sp/>{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">MarmotMaterialFiniteStrain::MarmotMaterialFiniteStrain;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>elastic<sp/>constants</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a06ed636c2ffbb190168ef1bd37210222" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af241e194ffa0091b0ed0ed6d80cca05d" kindref="member">K</ref>,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a06ed636c2ffbb190168ef1bd37210222" kindref="member">G</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>plasticity<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8d32d996ff8e70aeed5366217d80a015" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref>,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aa74b22fbe3c96b4f692f87dc6f9fb784" kindref="member">fyInf</ref>,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8d32d996ff8e70aeed5366217d80a015" kindref="member">eta</ref>,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a989af2d7a68835d72fa64611b54120c5" kindref="member">H</ref>;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>implementation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a2899614611d275d7410c8ad88ea021a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a2899614611d275d7410c8ad88ea021a1" kindref="member">implementationType</ref>;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aff76dcef75e33d757316b16ad6859ad3" kindref="member">FiniteStrainJ2Plasticity</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/><ref refid="classMarmotMaterial_1a0f631d6ec14531146ec683712a085960" kindref="member">materialProperties</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classMarmotMaterial_1a0b6c5faf3cb8abd50c67146dad8c175a" kindref="member">nMaterialProperties</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>materialLabel<sp/>);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a73e4c4ba13e91655b921d11c7ce1787e" kindref="member">computeStress</ref>(<sp/><ref refid="structMarmotMaterialFiniteStrain_1_1ConstitutiveResponse" kindref="compound">ConstitutiveResponse&lt; 3 &gt;</ref>&amp;<sp/>response,</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1AlgorithmicModuli" kindref="compound">AlgorithmicModuli&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>tangents,</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1Deformation" kindref="compound">Deformation&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>deformation,</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1TimeIncrement" kindref="compound">TimeIncrement</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeIncrement<sp/>);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a308024c4bc2667ac9da19c36040a17b4" kindref="member">computeStressWithScalarReturnMapping</ref>(<sp/><ref refid="structMarmotMaterialFiniteStrain_1_1ConstitutiveResponse" kindref="compound">ConstitutiveResponse&lt; 3 &gt;</ref>&amp;<sp/>response,</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1AlgorithmicModuli" kindref="compound">AlgorithmicModuli&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>tangents,</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1Deformation" kindref="compound">Deformation&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>deformation,</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1TimeIncrement" kindref="compound">TimeIncrement</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeIncrement<sp/>);</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ab3f35523cfdd769fbf4cd8ba36ad5239" kindref="member">computeStressWithFullReturnMapping</ref>(<sp/><ref refid="structMarmotMaterialFiniteStrain_1_1ConstitutiveResponse" kindref="compound">ConstitutiveResponse&lt; 3 &gt;</ref>&amp;<sp/>response,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1AlgorithmicModuli" kindref="compound">AlgorithmicModuli&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>tangents,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1Deformation" kindref="compound">Deformation&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>deformation,</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1TimeIncrement" kindref="compound">TimeIncrement</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeIncrement<sp/>);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a12b11aadca8877c987c9008dbfca7871" kindref="member">computeStressFDAF</ref>(<sp/><ref refid="structMarmotMaterialFiniteStrain_1_1ConstitutiveResponse" kindref="compound">ConstitutiveResponse&lt; 3 &gt;</ref>&amp;<sp/>response,</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1AlgorithmicModuli" kindref="compound">AlgorithmicModuli&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>tangents,</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1Deformation" kindref="compound">Deformation&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>deformation,</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1TimeIncrement" kindref="compound">TimeIncrement</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeIncrement<sp/>);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1acd0c6ddabf26ebbcdbd077c5f4d68520" kindref="member">computeStressFDAC</ref>(<sp/><ref refid="structMarmotMaterialFiniteStrain_1_1ConstitutiveResponse" kindref="compound">ConstitutiveResponse&lt; 3 &gt;</ref>&amp;<sp/>response,</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1AlgorithmicModuli" kindref="compound">AlgorithmicModuli&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>tangents,</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1Deformation" kindref="compound">Deformation&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>deformation,</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1TimeIncrement" kindref="compound">TimeIncrement</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeIncrement<sp/>);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8bede4f47b6993b44b9d2978c8329f02" kindref="member">computeStressCSDA</ref>(<sp/><ref refid="structMarmotMaterialFiniteStrain_1_1ConstitutiveResponse" kindref="compound">ConstitutiveResponse&lt; 3 &gt;</ref>&amp;<sp/>response,</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1AlgorithmicModuli" kindref="compound">AlgorithmicModuli&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>tangents,</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1Deformation" kindref="compound">Deformation&lt; 3 &gt;</ref>&amp;<sp/><sp/><sp/><sp/>deformation,</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structMarmotMaterialFiniteStrain_1_1TimeIncrement" kindref="compound">TimeIncrement</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>timeIncrement<sp/>);</highlight></codeline>
<codeline lineno="84" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a772738c665da6e23fea781a527d2a0a4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a772738c665da6e23fea781a527d2a0a4" kindref="member">getNumberOfRequiredStateVars</ref>()<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a8ada4260920cc53b8419dbfe2b9e8f26" kindref="member">FiniteStrainJ2PlasticityStateVarManager::layout</ref>.nRequiredStateVars;<sp/>}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a50522dae9457bf4d8b1d580b846b6a25" kindref="member">FiniteStrainJ2PlasticityStateVarManager</ref><sp/>:<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="classMarmotStateVarVectorManager_1a97534e3961835baf08ff7878e492611d" kindref="member">MarmotStateVarVectorManager</ref><sp/>{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="89" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a8ada4260920cc53b8419dbfe2b9e8f26" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a8ada4260920cc53b8419dbfe2b9e8f26" kindref="member">layout</ref><sp/>=<sp/><ref refid="classMarmotStateVarVectorManager_1a82db8384f80aa3ba337203e6f769ad84" kindref="member">makeLayout</ref>(<sp/>{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Fp&quot;</highlight><highlight class="normal">,<sp/>.length<sp/>=<sp/>9<sp/>},</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/>.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;alphaP&quot;</highlight><highlight class="normal">,<sp/>.length<sp/>=<sp/>1<sp/>},</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1af091c3c33164345c9e214595e046d9b8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Fastor::TensorMap&lt;<sp/>double,<sp/>3,<sp/>3<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1af091c3c33164345c9e214595e046d9b8" kindref="member">Fp</ref>;</highlight></codeline>
<codeline lineno="95" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1aa1ba8e49d3e9ebe9433444e671980476" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1aa1ba8e49d3e9ebe9433444e671980476" kindref="member">alphaP</ref>;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a50522dae9457bf4d8b1d580b846b6a25" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a50522dae9457bf4d8b1d580b846b6a25" kindref="member">FiniteStrainJ2PlasticityStateVarManager</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>theStateVarVector<sp/>)</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="classMarmotStateVarVectorManager_1a97534e3961835baf08ff7878e492611d" kindref="member">MarmotStateVarVectorManager</ref>(<sp/>theStateVarVector,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1a8ada4260920cc53b8419dbfe2b9e8f26" kindref="member">layout</ref><sp/>),<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1af091c3c33164345c9e214595e046d9b8" kindref="member">Fp</ref>(<sp/>&amp;<ref refid="classMarmotStateVarVectorManager_1ad8bf865c6eb13081e0fea4d70eb1f989" kindref="member">find</ref>(<sp/></highlight><highlight class="stringliteral">&quot;Fp&quot;</highlight><highlight class="normal"><sp/>)<sp/>),<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1_1FiniteStrainJ2PlasticityStateVarManager_1aa1ba8e49d3e9ebe9433444e671980476" kindref="member">alphaP</ref>(<sp/><ref refid="classMarmotStateVarVectorManager_1ad8bf865c6eb13081e0fea4d70eb1f989" kindref="member">find</ref>(<sp/></highlight><highlight class="stringliteral">&quot;alphaP&quot;</highlight><highlight class="normal"><sp/>)<sp/>){};</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="100" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7910b687083b42f69dbb800a15b8d191" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::unique_ptr&lt;<sp/>FiniteStrainJ2PlasticityStateVarManager<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7910b687083b42f69dbb800a15b8d191" kindref="member">stateVars</ref>;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a919a2545ce365585fe25fa7497fd7440" kindref="member">assignStateVars</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7910b687083b42f69dbb800a15b8d191" kindref="member">stateVars</ref>,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classMarmotMaterial_1a9b7554e1cb090e36004b1590f6cdb73c" kindref="member">nStateVars</ref><sp/>);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structStateView" kindref="compound">StateView</ref><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af652c8fa2c2664e80a66a4684665dd6d" kindref="member">getStateView</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::string&amp;<sp/>result<sp/>);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aed49aa303577337c673aacee3f54a88d" kindref="member">initializeYourself</ref>();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7b2090519af0e8c7dc6b953974653c6b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>double,<sp/>Tensor33d,<sp/>double<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7b2090519af0e8c7dc6b953974653c6b" kindref="member">yieldFunction</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>Fe,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>mandelStress;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dMandel_dFe;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>mandelStress,<sp/>dMandel_dFe<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7050170ba2b009214be90f7f6742c6ce" kindref="member">computeMandelStress</ref>(<sp/>Fe<sp/>);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>f;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>df_dMandel;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>d2f_dMandel_dMandel;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>df_dFe;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dMandel,<sp/>d2f_dMandel_dMandel,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a190ba39388668a757cd726fb090c30c3" kindref="member">yieldFunctionFromStress</ref>(<sp/>mandelStress,<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>df_dFe<sp/>=<sp/>einsum&lt;<sp/>IJ,<sp/>IJKL<sp/>&gt;(<sp/>df_dMandel,<sp/>dMandel_dFe<sp/>);</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>f,<sp/>df_dFe,<sp/>df_dBetaP<sp/>};</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="128" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a190ba39388668a757cd726fb090c30c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>T<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a190ba39388668a757cd726fb090c30c3" kindref="member">yieldFunctionFromStress</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref>&amp;<sp/>mandelStress,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>dev<sp/>=<sp/><ref refid="namespaceMarmot_1ad8af416a52bd57f2eadaa0c931cd438e" kindref="member">deviatoric</ref>(<sp/>mandelStress<sp/>);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rho<sp/>=<sp/>sqrt(<sp/>Fastor::inner(<sp/>dev,<sp/>dev<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">(<sp/>rho<sp/>)<sp/>==<sp/>0.0<sp/>)</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rho<sp/>+=<sp/>1e-15;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>f<sp/>=<sp/>1.<sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>*<sp/>(<sp/>rho<sp/>-<sp/><ref refid="namespaceMarmot_1_1Constants_1a0d09803bb3b4546bc7685c44bef36cbc" kindref="member">Marmot::Constants::sqrt2_3</ref><sp/>*<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight></codeline>
<codeline lineno="138" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a23ca6d4a0906bb1bf48a44673415c553" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>double,<sp/>Tensor33d,<sp/>Tensor3333d,<sp/>double<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a23ca6d4a0906bb1bf48a44673415c553" kindref="member">yieldFunctionFromStress</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>mandelStress,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/><sp/>dev<sp/>=<sp/><ref refid="namespaceMarmot_1ad8af416a52bd57f2eadaa0c931cd438e" kindref="member">deviatoric</ref>(<sp/>mandelStress<sp/>);</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho<sp/>=<sp/>std::max(<sp/>sqrt(<sp/>Fastor::inner(<sp/>dev,<sp/>dev<sp/>)<sp/>),<sp/>1e-15<sp/>);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f<sp/><sp/><sp/>=<sp/>1.<sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>*<sp/>(<sp/>rho<sp/>-<sp/><ref refid="namespaceMarmot_1_1Constants_1a0d09803bb3b4546bc7685c44bef36cbc" kindref="member">Marmot::Constants::sqrt2_3</ref><sp/>*<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>dRho_dMandel<sp/>=<sp/>1.<sp/>/<sp/>rho<sp/>*<sp/>dev;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>d2Rho_dMandel_dMandel<sp/>=<sp/>-1.0<sp/>/<sp/>std::pow(<sp/>rho,<sp/>3<sp/>)<sp/>*<sp/>outer(<sp/>dev,<sp/>dev<sp/>)<sp/>+</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>/<sp/>rho<sp/>*</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<sp/>einsum&lt;<sp/>ik,<sp/>jl,<sp/>to_ijkl<sp/>&gt;(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref>,<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref><sp/>)<sp/>-</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>/<sp/>3<sp/>*</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>einsum&lt;<sp/>ij,<sp/>IK,<sp/>IL,<sp/>to_ijKL<sp/>&gt;(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref>,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref>,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>d2f_dMandel_dMandel<sp/>=<sp/>1.<sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>*<sp/>d2Rho_dMandel_dMandel;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>df_dMandel<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>1.<sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>*<sp/>dRho_dMandel;</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>f,<sp/>df_dMandel,<sp/>d2f_dMandel_dMandel,<sp/>-<ref refid="namespaceMarmot_1_1Constants_1a0d09803bb3b4546bc7685c44bef36cbc" kindref="member">Constants::sqrt2_3</ref><sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>};</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="161" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a82c18a36b6b0bec286f472160db44b3e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>T,<sp/>Tensor33t&lt;<sp/>T<sp/>&gt;,<sp/>T<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a82c18a36b6b0bec286f472160db44b3e" kindref="member">yieldFunctionFromStressFirstOrderDerived</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref>&amp;<sp/>mandelStress,</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>dev<sp/>=<sp/><ref refid="namespaceMarmot_1ad8af416a52bd57f2eadaa0c931cd438e" kindref="member">deviatoric</ref>(<sp/>mandelStress<sp/>);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rho<sp/>=<sp/>sqrt(<sp/>Fastor::inner(<sp/>dev,<sp/>dev<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="namespaceMarmot_1_1Math_1a335a5f714ab10341744d8fea021e08dd" kindref="member">Math::makeReal</ref>(<sp/>rho<sp/>)<sp/>==<sp/>0.0<sp/>)</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rho<sp/>+=<sp/>1e-15;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>f<sp/>=<sp/>1.<sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>*<sp/>(<sp/>rho<sp/>-<sp/><ref refid="namespaceMarmot_1_1Constants_1a0d09803bb3b4546bc7685c44bef36cbc" kindref="member">Marmot::Constants::sqrt2_3</ref><sp/>*<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>dRho_dMandel<sp/>=<sp/><ref refid="namespaceMarmot_1a1d6bef1a2dab561af43ae5cd570c0d4b" kindref="member">multiplyFastorTensorWithScalar</ref>(<sp/>dev,<sp/>1.<sp/>/<sp/>rho<sp/>);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>df_dMandel<sp/>=<sp/><ref refid="namespaceMarmot_1a1d6bef1a2dab561af43ae5cd570c0d4b" kindref="member">multiplyFastorTensorWithScalar</ref>(<sp/>dRho_dMandel,<sp/>T(<sp/>1.<sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>f,<sp/>df_dMandel,<sp/>T(<sp/>-<ref refid="namespaceMarmot_1_1Constants_1a0d09803bb3b4546bc7685c44bef36cbc" kindref="member">Constants::sqrt2_3</ref><sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>)<sp/>};</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ada9603edf0333ac06ea294f9052d11f7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ada9603edf0333ac06ea294f9052d11f7" kindref="member">isYielding</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>Fe,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/>f,<sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>df_dFe;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dFe,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7b2090519af0e8c7dc6b953974653c6b" kindref="member">yieldFunction</ref>(<sp/>Fe,<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>f<sp/>&gt;<sp/>0.0<sp/>)</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7050170ba2b009214be90f7f6742c6ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>Tensor33d,<sp/>Tensor3333d<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7050170ba2b009214be90f7f6742c6ce" kindref="member">computeMandelStress</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>Fe<sp/>)</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceMarmot_1_1ContinuumMechanics" kindref="compound">Marmot::ContinuumMechanics</ref>;</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>Ce;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dCe_dFe;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>Ce,<sp/>dCe_dFe<sp/>)<sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1DeformationMeasures_1_1FirstOrderDerived_1a7c435347eb77e9167ff714385f6e35cb" kindref="member">DeformationMeasures::FirstOrderDerived::CauchyGreen</ref>(<sp/>Fe<sp/>);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>psi_;</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>dPsi_dCe;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>d2Psi_dCedCe,<sp/>dMandel_dCe;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>psi_,<sp/>dPsi_dCe,<sp/>d2Psi_dCedCe<sp/>)<sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1EnergyDensityFunctions_1_1SecondOrderDerived_1aad1774c5d8d6e561b83fcad98982a4d7" kindref="member">EnergyDensityFunctions::SecondOrderDerived::PenceGouPotentialB</ref>(<sp/>Ce,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af241e194ffa0091b0ed0ed6d80cca05d" kindref="member">K</ref>,</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a06ed636c2ffbb190168ef1bd37210222" kindref="member">G</ref><sp/>);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PK2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>2.0<sp/>*<sp/>dPsi_dCe;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>mandel<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>Ce<sp/>%<sp/>PK2;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>const<sp/>Tensor33d<sp/>mandel<sp/>=<sp/>einsum&lt;<sp/>Ii,<sp/>iJ<sp/>&gt;(<sp/>Ce,<sp/>PK2<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dMandel_dCe<sp/>=<sp/>einsum&lt;<sp/>Ii,<sp/>iJKL,<sp/>to_IJKL<sp/>&gt;(<sp/>Ce,<sp/>2.<sp/>*<sp/>d2Psi_dCedCe<sp/>)<sp/>+</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>einsum&lt;<sp/>IK,<sp/>iL,<sp/>iJ,<sp/>to_IJKL<sp/>&gt;(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref>,<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref>,<sp/>PK2<sp/>);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dMandel_dFe<sp/>=<sp/>einsum&lt;<sp/>IJKL,<sp/>KLMN<sp/>&gt;(<sp/>dMandel_dCe,<sp/>dCe_dFe<sp/>);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>mandel,<sp/>dMandel_dFe<sp/>};</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="212" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af2ffb7b627c7b626f0e319cc997de2bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af2ffb7b627c7b626f0e319cc997de2bb" kindref="member">computeMandelStressOnly</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref>&amp;<sp/>Fe<sp/>)</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceMarmot_1_1ContinuumMechanics" kindref="compound">Marmot::ContinuumMechanics</ref>;</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>Ce<sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1DeformationMeasures_1a64c531660e6ae1833c8ab1d97a1222b5" kindref="member">DeformationMeasures::CauchyGreen</ref>(<sp/>Fe<sp/>);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>psi_;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>dPsi_dCe;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>psi_,<sp/>dPsi_dCe<sp/>)<sp/><sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1EnergyDensityFunctions_1_1FirstOrderDerived_1ad90fe082770de30a11d0af8f1d301105" kindref="member">EnergyDensityFunctions::FirstOrderDerived::PenceGouPotentialB</ref>(<sp/>Ce,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af241e194ffa0091b0ed0ed6d80cca05d" kindref="member">K</ref>,<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a06ed636c2ffbb190168ef1bd37210222" kindref="member">G</ref><sp/>);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PK2<sp/><sp/><sp/><sp/>=<sp/><ref refid="namespaceMarmot_1a1d6bef1a2dab561af43ae5cd570c0d4b" kindref="member">multiplyFastorTensorWithScalar</ref>(<sp/>dPsi_dCe,<sp/>T(<sp/>2.0<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>mandel<sp/>=<sp/>Ce<sp/>%<sp/>PK2;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mandel;</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="227" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a52fad614ee4a6c1e64e708a468430b74" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>T<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a52fad614ee4a6c1e64e708a468430b74" kindref="member">computeBetaPOnly</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>alphaP<sp/>)</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>beta<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aa74b22fbe3c96b4f692f87dc6f9fb784" kindref="member">fyInf</ref><sp/>+<sp/>(<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>-<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aa74b22fbe3c96b4f692f87dc6f9fb784" kindref="member">fyInf</ref><sp/>)<sp/>*<sp/>exp(<sp/>-alphaP<sp/>*<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8d32d996ff8e70aeed5366217d80a015" kindref="member">eta</ref><sp/>)<sp/>+<sp/>alphaP<sp/>*<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a989af2d7a68835d72fa64611b54120c5" kindref="member">H</ref>;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>beta;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="232" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ab38ec6037be8323b618af94895e95640" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>double,<sp/>double<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ab38ec6037be8323b618af94895e95640" kindref="member">computeBetaP</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphaP<sp/>)</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>beta<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aa74b22fbe3c96b4f692f87dc6f9fb784" kindref="member">fyInf</ref><sp/>+<sp/>(<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>-<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aa74b22fbe3c96b4f692f87dc6f9fb784" kindref="member">fyInf</ref><sp/>)<sp/>*<sp/>exp(<sp/>-alphaP<sp/>*<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8d32d996ff8e70aeed5366217d80a015" kindref="member">eta</ref><sp/>)<sp/>+<sp/>alphaP<sp/>*<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a989af2d7a68835d72fa64611b54120c5" kindref="member">H</ref>;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dBetaP_dAlphaP<sp/>=<sp/>-<ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8d32d996ff8e70aeed5366217d80a015" kindref="member">eta</ref><sp/>*<sp/>(<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref><sp/>-<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1aa74b22fbe3c96b4f692f87dc6f9fb784" kindref="member">fyInf</ref><sp/>)<sp/>*<sp/>exp(<sp/>-alphaP<sp/>*<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a8d32d996ff8e70aeed5366217d80a015" kindref="member">eta</ref><sp/>)<sp/>+<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a989af2d7a68835d72fa64611b54120c5" kindref="member">H</ref>;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>beta,<sp/>dBetaP_dAlphaP<sp/>};</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a0a6fe26407bd4afd9e306bf58658d14b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>double,<sp/>double<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a0a6fe26407bd4afd9e306bf58658d14b" kindref="member">g</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>Fe_trial,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>df_dS,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dLambda,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>dFp,<sp/>ddFp_ddLambda;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>dFp,<sp/>ddFp_ddLambda<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a5a0a05f484cb98aca3f6e113666ec91f" kindref="member">computePlasticIncrement</ref>(<sp/>df_dS,<sp/>dLambda<sp/>);</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/>f,<sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>df_dFe;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>dFpInv<sp/><sp/><sp/>=<sp/>Fastor::inverse(<sp/>dFp<sp/>);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dFe_ddFp<sp/>=<sp/>einsum&lt;<sp/>iI,<sp/>iJKL<sp/>&gt;(<sp/>Fe_trial,<sp/>einsum&lt;<sp/>LI,<sp/>JK,<sp/>to_IJKL<sp/>&gt;(<sp/>-dFpInv,<sp/>dFpInv<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dFe,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7b2090519af0e8c7dc6b953974653c6b" kindref="member">yieldFunction</ref>(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>(<sp/>Fe_trial<sp/>%<sp/>dFpInv<sp/>),<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>df_ddLambda<sp/>=<sp/>einsum&lt;<sp/>IJ,<sp/>IJKL,<sp/>KL<sp/>&gt;(<sp/>df_dFe,<sp/>dFe_ddFp,<sp/>ddFp_ddLambda<sp/>).toscalar();</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>f,<sp/>df_ddLambda<sp/>};</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="258" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a796cbf1732eb149bdfa95e6886b23f25" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a796cbf1732eb149bdfa95e6886b23f25" kindref="member">computeReturnMappingDirection</ref>(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>Fe,<sp/>T<sp/>betaP<sp/>)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>mandelStressTrial;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dMandel_dFe;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>mandelStressTrial,<sp/>dMandel_dFe<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7050170ba2b009214be90f7f6742c6ce" kindref="member">computeMandelStress</ref>(<sp/>Fe<sp/>);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/>f,<sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>df_dS;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dS,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a190ba39388668a757cd726fb090c30c3" kindref="member">yieldFunctionFromStress</ref>(<sp/>mandelStressTrial,<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>df_dS;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="272" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a5a0a05f484cb98aca3f6e113666ec91f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>Tensor33d,<sp/>Tensor33d<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a5a0a05f484cb98aca3f6e113666ec91f" kindref="member">computePlasticIncrement</ref>(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>df_dS,<sp/>T<sp/>dLambda<sp/>)</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>dGp<sp/>=<sp/><ref refid="namespaceMarmot_1a1d6bef1a2dab561af43ae5cd570c0d4b" kindref="member">multiplyFastorTensorWithScalar</ref>(<sp/>df_dS,<sp/>dLambda<sp/>);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>dFp;</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>ddFp_ddGp;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>dFp,<sp/>ddFp_ddGp<sp/>)<sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1FiniteStrain_1_1Plasticity_1_1FlowIntegration_1_1FirstOrderDerived_1ac5090d6bd5c231cd5a3c780492eb8e04" kindref="member">ContinuumMechanics::FiniteStrain::Plasticity::FlowIntegration::FirstOrderDerived::</ref></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1FiniteStrain_1_1Plasticity_1_1FlowIntegration_1_1FirstOrderDerived_1ac5090d6bd5c231cd5a3c780492eb8e04" kindref="member">        exponentialMap</ref>(<sp/>dGp<sp/>);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>dFp,<sp/>einsum&lt;<sp/>IJKL,<sp/>KL<sp/>&gt;(<sp/>ddFp_ddGp,<sp/>df_dS<sp/>)<sp/>};</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="283"><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T<sp/>&gt;</highlight></codeline>
<codeline lineno="285" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a999f513b3b26b0e9874fd20bb16c919f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1a84db4851c64a953358752fe25430f7ee" kindref="member">VectorXt&lt; T &gt;</ref><sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a999f513b3b26b0e9874fd20bb16c919f" kindref="member">computeResidualVector</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1a84db4851c64a953358752fe25430f7ee" kindref="member">VectorXt&lt; T &gt;</ref>&amp;<sp/>X,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/>FeTrial,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphaPTrial<sp/>)</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idxA<sp/>=<sp/>9;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idxF<sp/>=<sp/>10;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal">Eigen;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">mV9t<sp/>=<sp/>Eigen::Map&lt;<sp/>Eigen::Matrix&lt;<sp/>T,<sp/>9,<sp/>1<sp/>&gt;<sp/>&gt;;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1a84db4851c64a953358752fe25430f7ee" kindref="member">VectorXt&lt; T &gt;</ref><sp/>R(<sp/>11<sp/>);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>residual</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>R.segment&lt;<sp/>9<sp/>&gt;(<sp/>0<sp/>)<sp/>=<sp/>-mV9t(<sp/>fastorTensorFromDoubleTensor&lt;<sp/>T<sp/>&gt;(<sp/>FeTrial</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>).data()<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>9<sp/>)<sp/>=<sp/>-alphaPTrial;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>Fe(<sp/>X.segment(<sp/>0,<sp/>9<sp/>).data()<sp/>);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>dLambda<sp/>=<sp/>X(<sp/>10<sp/>);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>alphaP<sp/><sp/>=<sp/>X(<sp/>9<sp/>);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>betaP<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a52fad614ee4a6c1e64e708a468430b74" kindref="member">computeBetaPOnly</ref>(<sp/>alphaP<sp/>);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>mandel<sp/>stress</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>mandelStress<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1af2ffb7b627c7b626f0e319cc997de2bb" kindref="member">computeMandelStressOnly</ref>(<sp/>Fe<sp/>);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>df_dMandel;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dMandel,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a82c18a36b6b0bec286f472160db44b3e" kindref="member">yieldFunctionFromStressFirstOrderDerived</ref>(<sp/>mandelStress,<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>dGp<sp/>=<sp/><ref refid="namespaceMarmot_1a1d6bef1a2dab561af43ae5cd570c0d4b" kindref="member">multiplyFastorTensorWithScalar</ref>(<sp/>df_dMandel,<sp/>dLambda<sp/>);</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref><sp/>dFp<sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1FiniteStrain_1_1Plasticity_1_1FlowIntegration_1ad35ebc36e298a4bf78bcbb7c92d7310e" kindref="member">ContinuumMechanics::FiniteStrain::Plasticity::FlowIntegration::exponentialMap</ref>(<sp/>dGp<sp/>);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1a84db4851c64a953358752fe25430f7ee" kindref="member">VectorXt&lt; T &gt;</ref><sp/>aux<sp/>=<sp/>mV9t(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1af247e2b29b4bc9e170538bb33421094c" kindref="member">Tensor33t&lt; T &gt;</ref>(<sp/>einsum&lt;<sp/>iJ,<sp/>JK<sp/>&gt;(<sp/>Fe,<sp/>dFp<sp/>)<sp/>).data()<sp/>)<sp/>-</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mV9t(<sp/><ref refid="namespaceMarmot_1a53b77e34e976cbebf5a2a1484488952f" kindref="member">fastorTensorFromDoubleTensor&lt; T &gt;</ref>(<sp/>FeTrial<sp/>).data()<sp/>);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>0<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>0<sp/>);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>1<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>1<sp/>);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>2<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>2<sp/>);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>3<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>3<sp/>);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>4<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>4<sp/>);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>5<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>5<sp/>);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>6<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>6<sp/>);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>7<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>7<sp/>);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>8<sp/>)<sp/><sp/><sp/><sp/>=<sp/>aux(<sp/>8<sp/>);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>idxA<sp/>)<sp/>=<sp/>(<sp/>alphaP<sp/>+<sp/>dLambda<sp/>*<sp/>df_dBetaP<sp/>)<sp/>-<sp/>alphaPTrial;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>idxF<sp/>)<sp/>=<sp/>f;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>R;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="331" refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a631a468733747f7162841272ce29c30a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>std::tuple&lt;<sp/>Eigen::VectorXd,<sp/>Eigen::MatrixXd<sp/>&gt;<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a631a468733747f7162841272ce29c30a" kindref="member">computeResidualVectorAndTangent</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>Eigen::VectorXd&amp;<sp/>X,</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>&amp;<sp/><sp/><sp/><sp/><sp/><sp/><sp/>FeTrial,</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alphaPTrial<sp/>)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idxA<sp/>=<sp/>9;</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>idxF<sp/>=<sp/>10;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal">Eigen;</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">mV9d<sp/>=<sp/>Eigen::Map&lt;<sp/>Eigen::Matrix&lt;<sp/>double,<sp/>9,<sp/>1<sp/>&gt;<sp/>&gt;;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">mM9d<sp/>=<sp/>Eigen::Map&lt;<sp/>Eigen::Matrix&lt;<sp/>double,<sp/>9,<sp/>9<sp/>&gt;<sp/>&gt;;</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>VectorXd<sp/>R(<sp/>11<sp/>);</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>MatrixXd<sp/>dR_dX(<sp/>11,<sp/>11<sp/>);</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX.setZero();</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>residual</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R.segment&lt;<sp/>9<sp/>&gt;(<sp/>0<sp/>)<sp/>=<sp/>-mV9d(<sp/>FeTrial.data()<sp/>);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>9<sp/>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>-alphaPTrial;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>Fe(<sp/>X.segment(<sp/>0,<sp/>9<sp/>).data()<sp/>);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dLambda<sp/>=<sp/>X(<sp/>10<sp/>);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphaP<sp/><sp/>=<sp/>X(<sp/>9<sp/>);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>std::cout<sp/>&lt;&lt;<sp/>&quot;dLambda:<sp/>&quot;<sp/>&lt;&lt;<sp/>dLambda<sp/>&lt;&lt;<sp/>std::endl;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>betaP,<sp/>dBetaP_dAlphaP;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>betaP,<sp/>dBetaP_dAlphaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ab38ec6037be8323b618af94895e95640" kindref="member">computeBetaP</ref>(<sp/>alphaP<sp/>);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>mandel<sp/>stress</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>mandelStress;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dMandel_dFe,<sp/>d2f_dMandel_dMandel;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>mandelStress,<sp/>dMandel_dFe<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7050170ba2b009214be90f7f6742c6ce" kindref="member">computeMandelStress</ref>(<sp/>Fe<sp/>);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><sp/><sp/><sp/>f,<sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>df_dMandel;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dMandel,<sp/>d2f_dMandel_dMandel,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a190ba39388668a757cd726fb090c30c3" kindref="member">yieldFunctionFromStress</ref>(<sp/>mandelStress,<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>dGp<sp/>=<sp/>dLambda<sp/>*<sp/>df_dMandel;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>dFp;</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>ddFp_ddGp;</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>dFp,<sp/>ddFp_ddGp<sp/>)<sp/>=<sp/><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1FiniteStrain_1_1Plasticity_1_1FlowIntegration_1_1FirstOrderDerived_1ac5090d6bd5c231cd5a3c780492eb8e04" kindref="member">ContinuumMechanics::FiniteStrain::Plasticity::FlowIntegration::FirstOrderDerived::</ref></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><ref refid="namespaceMarmot_1_1ContinuumMechanics_1_1FiniteStrain_1_1Plasticity_1_1FlowIntegration_1_1FirstOrderDerived_1ac5090d6bd5c231cd5a3c780492eb8e04" kindref="member">        exponentialMap</ref>(<sp/>dGp<sp/>);</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>ddGp_dFe<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>dLambda<sp/>*<sp/>einsum&lt;<sp/>ijmn,<sp/>mnkL<sp/>&gt;(<sp/>d2f_dMandel_dMandel,<sp/>dMandel_dFe<sp/>);</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/><sp/><sp/>ddFp_ddLambda<sp/>=<sp/>einsum&lt;<sp/>IJKL,<sp/>KL<sp/>&gt;(<sp/>ddFp_ddGp,<sp/>df_dMandel<sp/>);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>ddFp_dFe<sp/>=<sp/>einsum&lt;<sp/>iImn,<sp/>mnkL<sp/>&gt;(<sp/>ddFp_ddGp,<sp/>ddGp_dFe<sp/>);</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Tensor3333d<sp/>dFeTrial_dFe<sp/>=<sp/>einsum&lt;<sp/>iIkL,<sp/>iJ,<sp/>to_IJkL<sp/>&gt;(<sp/>ddFp_dFe,<sp/>Fe<sp/>)<sp/>+</highlight></codeline>
<codeline lineno="377"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>einsum&lt;<sp/>iI,<sp/>ik,<sp/>JL,<sp/>to_IJkL<sp/>&gt;(<sp/>dFp,</highlight></codeline>
<codeline lineno="379"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Spatial3D::I,<sp/>Spatial3D::I<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a65c78c55ef6ae2d308d54d2e8b214d67" kindref="member">Tensor3333d</ref><sp/>dFeTrial_dFe<sp/>=<sp/>einsum&lt;<sp/>iI,<sp/>IJKL<sp/>&gt;(<sp/>Fe,<sp/>ddFp_dFe<sp/>)<sp/>+</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>einsum&lt;<sp/>IK,<sp/>JL,<sp/>to_IJKL<sp/>&gt;(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref>,<sp/>transpose(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1_1Spatial3D_1ac7886a56e9b9adf66dd3635be909ed9e" kindref="member">Spatial3D::I</ref><sp/>%<sp/>dFp<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>std::cout<sp/>&lt;&lt;<sp/>&quot;ddFeTrial_dFe:<sp/>&quot;<sp/>&lt;&lt;<sp/>dFeTrial_dFe<sp/>&lt;&lt;<sp/>std::endl;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Tensor33d<sp/>dFe_ddLambda<sp/>=<sp/>einsum&lt;<sp/>iI,<sp/>iJ<sp/>&gt;(<sp/>ddFp_ddLambda,<sp/>Fe<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>dFe_ddLambda<sp/>=<sp/>einsum&lt;<sp/>Ii,<sp/>iJ<sp/>&gt;(<sp/>Fe,<sp/>ddFp_ddLambda<sp/>);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>df_dBetaP<sp/>=<sp/>-<ref refid="namespaceMarmot_1_1Constants_1a0d09803bb3b4546bc7685c44bef36cbc" kindref="member">Constants::sqrt2_3</ref><sp/>/<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1ac7d70dd51d1b55b3a4c010e116b7f613" kindref="member">fy</ref>;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Tensor33d<sp/>df_dFe<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>einsum&lt;<sp/>IJ,<sp/>IJKL<sp/>&gt;(<sp/>df_dMandel,</highlight></codeline>
<codeline lineno="391"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>dMandel_dFe<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref><sp/>df_dFe<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>einsum&lt;<sp/>IJ,<sp/>IJKL<sp/>&gt;(<sp/>df_dMandel,<sp/>dMandel_dFe<sp/>);</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::tie(<sp/>f,<sp/>df_dFe,<sp/>df_dBetaP<sp/>)<sp/>=<sp/><ref refid="classMarmot_1_1Materials_1_1FiniteStrainJ2Plasticity_1a7b2090519af0e8c7dc6b953974653c6b" kindref="member">yieldFunction</ref>(<sp/>Fe,<sp/>betaP<sp/>);</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>df_dFe<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>einsum&lt;<sp/>IJ,<sp/>IJKL<sp/>&gt;(<sp/>df_dMandel,<sp/>dMandel_dFe<sp/>);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>R.segment&lt;<sp/>9<sp/>&gt;(<sp/>0<sp/>)<sp/>+=<sp/>mV9d(<sp/>Tensor33d(<sp/>einsum&lt;<sp/>iI,<sp/>iJ<sp/>&gt;(<sp/>dFp,<sp/>Fe<sp/>)</highlight></codeline>
<codeline lineno="397"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>).data()<sp/>);<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R.segment&lt;<sp/>9<sp/>&gt;(<sp/>0<sp/>)<sp/>+=<sp/>mV9d(<sp/><ref refid="namespaceMarmot_1_1FastorStandardTensors_1a7ce3d36f5f3b545d636d13bee501d420" kindref="member">Tensor33d</ref>(<sp/>einsum&lt;<sp/>iJ,<sp/>JK<sp/>&gt;(<sp/>Fe,<sp/>dFp<sp/>)<sp/>).data()<sp/>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>idxA<sp/>)<sp/>+=<sp/>(<sp/>alphaP<sp/>+<sp/>dLambda<sp/>*<sp/>df_dBetaP<sp/>);</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>R(<sp/>idxF<sp/>)<sp/>=<sp/>f;</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX.block&lt;<sp/>9,<sp/>9<sp/>&gt;(<sp/>0,<sp/>0<sp/>)<sp/>=<sp/>mM9d(<sp/>dFeTrial_dFe.data()<sp/>).transpose();</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX.block&lt;<sp/>1,<sp/>9<sp/>&gt;(<sp/>idxF,<sp/>0<sp/>)<sp/>=<sp/>mV9d(<sp/>df_dFe.data()<sp/>);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX.block&lt;<sp/>9,<sp/>1<sp/>&gt;(<sp/>0,<sp/>idxF<sp/>)<sp/>=<sp/>mV9d(<sp/>dFe_ddLambda.data()<sp/>);</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX(<sp/>idxF,<sp/>idxA<sp/>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>df_dBetaP<sp/>*<sp/>dBetaP_dAlphaP;</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX(<sp/>idxA,<sp/>idxF<sp/>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>df_dBetaP;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dR_dX(<sp/>idxA,<sp/>idxA<sp/>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{<sp/>R,<sp/>dR_dX<sp/>};</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>Marmot::Materials</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/home/runner/work/Marmot/Marmot/modules/materials/FiniteStrainJ2Plasticity/include/Marmot/FiniteStrainJ2Plasticity.h"/>
  </compounddef>
</doxygen>
